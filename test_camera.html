<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Câmera</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h2>Teste de Câmera para Produtos</h2>
        
        <!-- Área de preview da imagem -->
        <div id="image-preview-container" class="mb-3" style="display: none;">
            <img id="image-preview" src="" alt="Preview" class="img-fluid rounded border" style="max-height: 300px;">
            <br>
            <button type="button" class="btn btn-sm btn-outline-danger mt-2" onclick="clearImage()">
                <i class="bi bi-trash"></i> Remover Foto
            </button>
        </div>
        
        <!-- Botões de captura -->
        <div class="d-grid gap-2 d-md-flex mb-3">
            <!-- Botão da câmera (mobile) -->
            <button type="button" class="btn btn-primary" onclick="openCamera()" id="camera-btn">
                <i class="bi bi-camera-fill"></i> Tirar Foto
            </button>
            
            <!-- Botão de arquivo (desktop/mobile) -->
            <button type="button" class="btn btn-secondary" onclick="selectFile()">
                <i class="bi bi-folder2-open"></i> Escolher Arquivo
            </button>
        </div>
        
        <!-- Input de arquivo (oculto) -->
        <input type="file" id="file-input" accept="image/*" style="display: none;" onchange="handleImageSelect(this)">
        
        <!-- Input de câmera (oculto) -->
        <input type="file" id="camera-input" accept="image/*" capture="environment" style="display: none;" onchange="handleImageSelect(this)">
        
        <div class="alert alert-info">
            <i class="bi bi-info-circle"></i> 
            Este é um teste da funcionalidade de câmera. Use a câmera para tirar uma foto ou escolha um arquivo do dispositivo.
        </div>
    </div>

    <script>
        function openCamera() {
            const cameraInput = document.getElementById('camera-input');
            cameraInput.click();
        }

        function selectFile() {
            const fileInput = document.getElementById('file-input');
            fileInput.click();
        }

        function handleImageSelect(input) {
            const file = input.files[0];
            if (file) {
                showImagePreview(file);
                console.log('Arquivo selecionado:', file.name, 'Tamanho:', file.size, 'bytes');
            }
        }

        function showImagePreview(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const preview = document.getElementById('image-preview');
                const container = document.getElementById('image-preview-container');
                
                preview.src = e.target.result;
                container.style.display = 'block';
            };
            reader.readAsDataURL(file);
        }

        function clearImage() {
            // Limpar inputs
            document.getElementById('file-input').value = '';
            document.getElementById('camera-input').value = '';
            
            // Esconder preview
            document.getElementById('image-preview-container').style.display = 'none';
            document.getElementById('image-preview').src = '';
        }

        // Detectar dispositivo
        document.addEventListener('DOMContentLoaded', function() {
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            const cameraBtn = document.getElementById('camera-btn');
            
            if (isMobile) {
                cameraBtn.innerHTML = '<i class="bi bi-camera-fill"></i> Câmera';
                console.log('Dispositivo móvel detectado');
            } else {
                console.log('Dispositivo desktop detectado');
            }
            
            // Verificar suporte a câmera
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                console.log('API de câmera suportada');
            } else {
                console.log('API de câmera não suportada');
            }
        });
    </script>
</body>
</html>
